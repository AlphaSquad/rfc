## Binning evaluation container

 * Version:    0.10.0
 * Maintainer: Peter Belmann <pbelmann@cebitec.uni-bielefeld.de>

### Contents

* Outline
* Input
  * General definition
     * Description 
     * Mounts
  * fasta
  * binning
  * scaffold_contig_mapping
  * databases
* Output 
* Example

### Outline

This specification describes the interface for containerised binning evaluation applications. 
A binning evaluation application should validate the assigned [BIN and/or TAXID ids](https://github.com/bioboxes/rfc/blob/master/data-format/binning.mkd#the-binning-output-format) 
of a binning container.

In addition to the specifications described below, this container MUST implement the
specifications defined in ['Generic bioinformatics container'](https://github.com/bioboxes/rfc/blob/master/rfc.mkd#generic-bioinformatics-container). 


### Inputs

#### General Definition

A biobox requires an input YAML with the following definition 

```YAML
---
version: NUMBER.NUMBER.NUMBER
arguments:
  sequences:
    path: STRING
    id: STRING
    type: contig
    format: fasta
  labels:
    path: STRING
    id: STRING
    type: binning
    format: bioboxes.org:/binning:0.9
  predictions:
    path: STRING
    id: STRING
    type: binning
    format: bioboxes.org:/binning:0.9
  databases: LIST
```

##### Description:

* **version**: The current version is specified directly under the heading.
* **arguments**: The arguments field consists of the following fields 
       * sequences
       * labels
       * predictions
       * databases     
       
       You can find a definition for every field below this section.

##### Mounts:
 * Your output directory MUST be mounted to /bbx/mnt/output
 * Your input files MUST be mounted to /bbx/mnt/input
 * The .yaml MUST be placed as /bbx/mnt/input/biobox.yaml

#### Definition:

##### File object entries

```YAML
  path: STRING
  id: STRING
  type: String
  format: STRING
```

* `path` means absolute path to file in container
* `id` is a unique id for the file (optional)
* `type` specifies the semantic type (optional)
* `format` gives a machine-checkable type definition (will be transformed to YAML tag in future)

##### File formats
* `fasta`: FASTA file
* `bioboxes.org:/binning:0.9`: bioboxes.org binning file in version 0.9

##### Description:

* This specifies the path to a tab separated file with the scaffold name in the first column and the contig name in the second column. The sequence names have to be equal to the sequence names specified in the FASTA file.

#### Databases definition:

```YAML
 - value: STRING
   id: ncbi_taxonomy 
```

##### Description:
* **value**: Path to a database directory.
* **type**: Database identifier. Each database identifier is a link to the directory structure. You can find the compressed version of the database with the corresponding structure on this ftp site: ftp://cami.psc.edu/ftp.ncbi.nlm.nih.gov/
  * **[refseq](https://github.com/bioboxes/rfc/blob/master/databases/refseq.txt)**  
  * **[blastdb](https://github.com/bioboxes/rfc/blob/master/databases/blastdb.txt)**
  * **[cog](https://github.com/bioboxes/rfc/blob/master/databases/cog.txt)**
  * **[ncbi_genomes](https://github.com/bioboxes/rfc/blob/master/databases/ncbi_genomes.txt)**
  * **[ncbi_taxonomy](https://github.com/bioboxes/rfc/blob/master/databases/ncbi_taxonomy.txt)**

### Outputs

The biobox produces on a successful run a `biobox.yaml` and can be found in the `bbx` directory in your mounted output directory. The output biobox.yaml must be in an evaluation specific [format](https://github.com/bioboxes/rfc/blob/master/data-format/evaluation.mkd).

### Example for input biobox.yaml

```YAML
---
version: 0.9.0
arguments:
   - fasta:
        value: "/path/to/lib1"
        id: "pe_1"
        type: contig
   - binning:
      - value: "/path/to/assigned/binning/file"
        type: assignments
      - value: "/path/to/true/binning/file"
        type: true
   - scaffold_contig_mapping: "/path/to/binning/file/mapping"
   - databases:
      - id: "ncbi_taxonomy"
        value: "/path/to/ncbi/taxonomy"
```

