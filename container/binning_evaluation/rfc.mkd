## Binning evaluation container

 * Version:    0.9.0
 * Maintainer: Peter Belmann <pbelmann@cebitec.uni-bielefeld.de>

### Contents

* Outline
* Inputs
  * General definition
     * Description 
     * Mounts
  * fasta
  * binning
  * scaffold_contig_mapping
  * databases
* Outputs 
* Example

### Outline

This specification describes the interface for containerised binning evaluation applications. 
A binning evaluation application should validate the assigned [BIN and/or TAXID ids](https://github.com/bioboxes/rfc/blob/master/data-format/binning.mkd#the-binning-output-format) 
of a binning container.

In addition to the specifications described below, this container MUST implement the
specifications defined in ['Generic bioinformatics container'](https://github.com/bioboxes/rfc/blob/master/rfc.mkd#generic-bioinformatics-container). 


### Inputs

#### General Definition

A biobox requires an input YAML with the following definition 

```YAML
---
version: NUMBER.NUMBER.NUMBER
arguments:
  - fasta:
       value: STRING
       id: STRING or NUMBER
       type: contig or scaffold
  - binning: 
     - value: STRING
       type: true
     - value: STRING
       type: assignments
  - scaffold_contig_mapping: STRING
  - database: LIST 
```

##### Description:

* **version**: The current version is specified directly under the heading.
* **arguments**: The arguments field consists out of the following fields 
       * fasta
       * binning
       * scaffold_contig_mapping
       * databases       
       
       You can find a definition for every field below this section.

##### Mounts:
 * The .yaml MUST be mounted to /bbx/input/biobox.yaml.
 * Your output directory MUST be mounted to /bbx/output.
 * Your input files MUST be mounted to /bbx/input. 

#### fasta definition:

```YAML
  value: STRING
  id: STRING or NUMBER
  type: contig or scaffold
```

##### Description:
* **value**: This is the path to a fasta file containing the contigs relative to your mounted output directory.
* **id**: A unique id for every entry in the fasta list.
* **type**: Two options:
  * **contig**
  * **scaffold**

#### binning definition:

```YAML
- value: STRING
  type: STRING
```

##### Description:
* **value**: This is the path to a [binning file](https://github.com/pbelmann/rfc/blob/master/data-format/binning.mkd).
* **type**: Type represents a boolean:
  * **true** : Binning file contains the true binning and/or taxonomic assignments.
  * **assigments** : Binning file contains the computed binning and/or taxonomic groups.

#### scaffold_contig_mapping definition:

```YAML
 - scaffold_contig_mapping: STRING
```

##### Description:

* This specifies the path to a tab separated file with the scaffold name in the first column and the contig name in the second column. The sequence names have to be equal to the sequence names specified in the FASTA file.

#### databases definition:

```YAML
 - value: STRING
   id: ncbi_taxonomy 
```

##### Description:
* **value**: Path to a database directory.
* **type**: Database identifier. Each database identifier is a link to the directory structure. You can find the compressed version of the database with the corresponding structure on this ftp site: ftp://cami.psc.edu/ftp.ncbi.nlm.nih.gov/
  * **[refseq](https://github.com/pbelmann/rfc/blob/feature/new_binning_spec/databases/refseq.txt)**  
  * **[blastdb](https://github.com/pbelmann/rfc/blob/feature/new_binning_spec/databases/blastdb.txt)**
  * **[cog](https://github.com/pbelmann/rfc/blob/feature/new_binning_spec/databases/cog.txt)**
  * **[ncbi_genomes](https://github.com/pbelmann/rfc/blob/feature/new_binning_spec/databases/ncbi_genomes.txt)**
  * **[ncbi_taxonomy](https://github.com/pbelmann/rfc/blob/feature/new_binning_spec/databases/ncbi_taxonomy.txt)**

### Outputs

The biobox produces on a successful run a `biobox.yaml` and can be found in the `bbx` directory in your mounted output directory. The output biobox.yaml must be in an evaluation specific [format](https://github.com/pbelmann/rfc/blob/master/data-format/binning.mkd).

### Example for input biobox.yaml

```YAML
---
version: 0.9.0
arguments:
   - fasta:
        value: "/path/to/lib1"
        id: "pe_1"
        type: contig
   - binning:
      - value: "/path/to/assigned/binning/file"
        type: assignments
      - value: "/path/to/true/binning/file"
        type: true
   - scaffold_contig_mapping:
      - value: "/path/to/binning/file/mapping"
   - databases:
      - id: "ncbi_taxonomy"
        value: "/path/to/ncbi/taxonomy"
```
